2025-12-01 14:35:50,266 - __main__ - INFO - ================================================================================
2025-12-01 14:35:50,266 - __main__ - INFO - MONGODB DATA QUALITY CHECKER - POST-INGESTION ANALYSIS
2025-12-01 14:35:50,266 - __main__ - INFO - ================================================================================
2025-12-01 14:35:50,266 - __main__ - INFO - 
2025-12-01 14:35:50,266 - __main__ - INFO - STEP 1: Connecting to MongoDB
2025-12-01 14:35:50,266 - __main__ - INFO - --------------------------------------------------------------------------------
2025-12-01 14:35:50,266 - __main__ - INFO - Connecting to MongoDB: mongodb:27017
2025-12-01 14:35:50,272 - __main__ - INFO - ✓ Connected to database: greencoop_forecast
2025-12-01 14:35:50,273 - __main__ - INFO - 
2025-12-01 14:35:50,273 - __main__ - INFO - STEP 2: Running 7 quality checks
2025-12-01 14:35:50,273 - __main__ - INFO - --------------------------------------------------------------------------------
2025-12-01 14:35:50,273 - __main__ - INFO - Running 7 quality checks...
2025-12-01 14:35:50,276 - __main__ - INFO -   Check 1: Missing required fields
2025-12-01 14:35:50,276 - __main__ - INFO -   Check 2: Duplicate records
2025-12-01 14:35:50,285 - __main__ - INFO -   Check 3: Data ranges
2025-12-01 14:35:50,305 - __main__ - INFO -   Check 4: Null percentages
2025-12-01 14:35:50,326 - __main__ - INFO -   Check 5: Unique values
2025-12-01 14:35:50,329 - __main__ - INFO -   Check 6: Type consistency
2025-12-01 14:35:50,341 - __main__ - INFO -   Check 7: Date coverage
2025-12-01 14:35:50,349 - __main__ - INFO - 
2025-12-01 14:35:50,349 - __main__ - INFO - STEP 3: Generating quality report
2025-12-01 14:35:50,349 - __main__ - INFO - --------------------------------------------------------------------------------
2025-12-01 14:35:50,349 - __main__ - INFO - ✓ Quality report saved to: logs/quality_report.txt
2025-12-01 14:35:50,349 - __main__ - INFO - ================================================================================
MONGODB DATA QUALITY REPORT - POST-INGESTION ANALYSIS
================================================================================

Report generated: 2025-12-01T14:35:50.276238+00:00

COLLECTION STATISTICS
--------------------------------------------------------------------------------
Total observations: 4950
Total stations: 6
Schema fields defined: 26

QUALITY CHECKS
--------------------------------------------------------------------------------
✓ Check 1: Missing Required Fields
    id_station: 0 records (0.0%)
    dh_utc: 0 records (0.0%)
✓ Check 2: Duplicates: 0 records (0.0%)
✓ Check 3: Data Ranges
    temperature:
      Min: 2.5, Max: 19.3, Avg: 11.73
      Records with data: 4950
    pression:
      Min: 991.2, Max: 1023.0, Avg: 1008.49
      Records with data: 4950
    humidite:
      Min: 49.0, Max: 100.0, Avg: 82.35
      Records with data: 4950
✓ Check 4: Null Percentages
    temperature: 0.0%
    pression: 0.0%
    humidite: 0.0%
    vent_moyen: 0.0%
    vent_rafales: 21.88%
    pluie_1h: 18.18%
    visibilite: 98.79%
    nebulosite: 98.79%
✓ Check 5: Unique Values
    unique_stations: 6
    unique_sources: 1
    unique_cities: 6
    schema_fields: 26
✓ Check 6: Type Consistency
    temperature_types: {'double': 4950}
    station_types: {'string': 4950}
✓ Check 7: Date Coverage
 Min date: 2024-10-01T00:04:00Z
 Max date: 2024-10-07T14:59:00Z
 Coverage: 32457.14%

ALERTS
--------------------------------------------------------------------------------
⚠️  High null rate for vent_rafales: 21.88%
⚠️  High null rate for visibilite: 98.79%
⚠️  High null rate for nebulosite: 98.79%

================================================================================
2025-12-01 14:35:50,350 - __main__ - INFO - ✓ Disconnected from MongoDB
2025-12-01 14:35:50,350 - __main__ - INFO - 
2025-12-01 14:35:50,350 - __main__ - INFO - ✅ SUCCESS - Quality check completed
