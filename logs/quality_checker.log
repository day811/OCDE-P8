2025-12-09 15:24:35,473 - __main__ - INFO - ================================================================================
2025-12-09 15:24:35,473 - __main__ - INFO - MONGODB DATA QUALITY CHECKER - POST-INGESTION ANALYSIS
2025-12-09 15:24:35,473 - __main__ - INFO - ================================================================================
2025-12-09 15:24:35,473 - __main__ - INFO - 
2025-12-09 15:24:35,473 - __main__ - INFO - STEP 1: Connecting to MongoDB
2025-12-09 15:24:35,473 - __main__ - INFO - --------------------------------------------------------------------------------
2025-12-09 15:24:35,473 - __main__ - INFO - Connecting to MongoDB: mongodb:27017
2025-12-09 15:24:35,480 - __main__ - INFO - ✓ Connected to database: greencoop_forecast
2025-12-09 15:24:35,480 - __main__ - INFO - 
2025-12-09 15:24:35,480 - __main__ - INFO - STEP 2: Running 7 quality checks
2025-12-09 15:24:35,480 - __main__ - INFO - --------------------------------------------------------------------------------
2025-12-09 15:24:35,480 - __main__ - INFO - Running 7 quality checks...
2025-12-09 15:24:35,483 - __main__ - INFO -   Check 1: Missing required fields
2025-12-09 15:24:35,484 - __main__ - INFO -   Check 2: Duplicate records
2025-12-09 15:24:35,492 - __main__ - INFO -   Check 3: Data ranges
2025-12-09 15:24:35,512 - __main__ - INFO -   Check 4: Null percentages
2025-12-09 15:24:35,534 - __main__ - INFO -   Check 5: Unique values
2025-12-09 15:24:35,538 - __main__ - INFO -   Check 6: Type consistency
2025-12-09 15:24:35,552 - __main__ - INFO -   Check 7: Date coverage
2025-12-09 15:24:35,561 - __main__ - WARNING - Date parsing error: Parser must be a string or character stream, not datetime
2025-12-09 15:24:35,561 - __main__ - INFO - 
2025-12-09 15:24:35,561 - __main__ - INFO - STEP 3: Generating quality report
2025-12-09 15:24:35,561 - __main__ - INFO - --------------------------------------------------------------------------------
2025-12-09 15:24:35,561 - __main__ - INFO - ✓ Quality report saved to: logs/quality_report.txt
2025-12-09 15:24:35,561 - __main__ - INFO - ================================================================================
MONGODB DATA QUALITY REPORT - POST-INGESTION ANALYSIS
================================================================================

Report generated: 2025-12-09T15:24:35.483611+00:00

COLLECTION STATISTICS
--------------------------------------------------------------------------------
Total observations: 4950
Total stations: 6
Schema fields defined: 26

QUALITY CHECKS
--------------------------------------------------------------------------------
✓ Check 1: Missing Required Fields
    id_station: 0 records (0.0%)
    dh_utc: 0 records (0.0%)
✓ Check 2: Duplicates: 0 records (0.0%)
✓ Check 3: Data Ranges
    temperature:
      Min: 2.5, Max: 19.3, Avg: 11.73
      Records with data: 4950
    pression:
      Min: 991.2, Max: 1023.0, Avg: 1008.49
      Records with data: 4950
    humidite:
      Min: 49.0, Max: 100.0, Avg: 82.35
      Records with data: 4950
✓ Check 4: Null Percentages
    temperature: 0.0%
    pression: 0.0%
    humidite: 0.0%
    vent_moyen: 0.0%
    vent_rafales: 21.88%
    pluie_1h: 18.18%
    visibilite: 98.79%
    nebulosite: 98.79%
✓ Check 5: Unique Values
    unique_stations: 6
    unique_sources: 1
    unique_cities: 6
    schema_fields: 26
✓ Check 6: Type Consistency
    temperature_types: {'double': 4950}
    station_types: {'string': 4950}
✓ Check 7: Date Coverage
 Min date: 2024-10-01 00:04:00
 Max date: 2024-10-07 14:59:00
 Coverage: 0%

ALERTS
--------------------------------------------------------------------------------
⚠️  High null rate for vent_rafales: 21.88%
⚠️  High null rate for visibilite: 98.79%
⚠️  High null rate for nebulosite: 98.79%

================================================================================
2025-12-09 15:24:35,562 - __main__ - INFO - ✓ Disconnected from MongoDB
2025-12-09 15:24:35,562 - __main__ - INFO - 
2025-12-09 15:24:35,563 - __main__ - INFO - ✅ SUCCESS - Quality check completed
